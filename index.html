<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Trading Journal</title>
<style>
    body {
        background-color: #111;
        color: white;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
    }
    h1 { text-align: center; }
    .form-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 15px;
    }
    .form-container input,
    .form-container select,
    .form-container button {
        padding: 8px;
        border-radius: 4px;
        border: none;
    }
    .form-container input,
    .form-container select {
        flex: 1;
        min-width: 120px;
    }
    .form-container button {
        background-color: #28a745;
        color: white;
        cursor: pointer;
    }
    .form-container button:hover {
        background-color: #218838;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        background-color: #222;
    }
    th, td {
        border: 1px solid #444;
        padding: 8px;
        text-align: center;
    }
    th {
        background-color: #333;
    }
    .profit { color: #0f0; }
    .loss { color: #f00; }
    @media (max-width: 768px) {
        table, thead, tbody, th, td, tr {
            display: block;
        }
        thead tr {
            display: none;
        }
        td {
            text-align: right;
            padding-left: 50%;
            position: relative;
        }
        td::before {
            position: absolute;
            left: 10px;
            white-space: nowrap;
        }
    }
</style>
</head>
<body>

<h1>Trading Journal</h1>

<div class="form-container">
    <input type="text" id="symbol" placeholder="Symbol">
    <select id="side">
        <option value="buy">Buy</option>
        <option value="sell">Sell</option>
    </select>
    <input type="number" id="leverage" placeholder="Leverage">
    <input type="number" id="entry" placeholder="Entry Price">
    <select id="targetType">
        <option value="tp">TP</option>
        <option value="sl">SL</option>
    </select>
    <input type="number" id="targetPrice" placeholder="Target Price">
    <input type="number" id="invest" placeholder="Invest">
    <button onclick="addTrade()">Add Trade</button>
</div>

<table>
    <thead>
        <tr>
            <th>Symbol</th>
            <th>Side</th>
            <th>Leverage</th>
            <th>Entry</th>
            <th>Target Type</th>
            <th>Target Price</th>
            <th>Invest</th>
            <th>Profit Amount</th>
            <th>Final Amount</th>
            <th>Date</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody id="tradeTable"></tbody>
</table>

<p id="totals">Total Amount: $0.00 | Total Profit: $0.00 | Total Loss: $0.00</p>

<script>
function formatUSD(value) {
    let num = parseFloat(value);
    if (isNaN(num)) num = 0;
    return "$" + num.toFixed(2);
}

function addTrade(editIndex = null) {
    let symbol = document.getElementById("symbol").value;
    let side = document.getElementById("side").value;
    let leverage = parseFloat(document.getElementById("leverage").value);
    let entry = parseFloat(document.getElementById("entry").value);
    let targetType = document.getElementById("targetType").value;
    let targetPrice = parseFloat(document.getElementById("targetPrice").value);
    let invest = parseFloat(document.getElementById("invest").value);

    if (!symbol || isNaN(leverage) || isNaN(entry) || isNaN(targetPrice) || isNaN(invest)) {
        alert("Please fill all fields with valid numbers.");
        return;
    }

    let priceDiff = targetPrice - entry;
    if (side === "sell") priceDiff = entry - targetPrice;

    let profitAmount = (priceDiff / entry) * leverage * invest;
    if (targetType === "sl") profitAmount = -Math.abs(profitAmount);

    let finalAmount = profitAmount; // can add fees/adjustments here

    let trades = JSON.parse(localStorage.getItem("trades") || "[]");

    let trade = {
        symbol, side, leverage, entry,
        targetType: targetType.toUpperCase(),
        targetPrice, invest,
        profitAmount: parseFloat(profitAmount.toFixed(2)),
        finalAmount: parseFloat(finalAmount.toFixed(2)),
        date: new Date().toLocaleDateString()
    };

    if (editIndex !== null) {
        trades[editIndex] = trade;
    } else {
        trades.push(trade);
    }

    localStorage.setItem("trades", JSON.stringify(trades));
    loadTrades();
    clearForm();
}

function clearForm() {
    document.getElementById("symbol").value = "";
    document.getElementById("side").value = "buy";
    document.getElementById("leverage").value = "";
    document.getElementById("entry").value = "";
    document.getElementById("targetType").value = "tp";
    document.getElementById("targetPrice").value = "";
    document.getElementById("invest").value = "";
}

function loadTrades() {
    let trades = JSON.parse(localStorage.getItem("trades") || "[]");
    let table = document.getElementById("tradeTable");
    table.innerHTML = "";

    let totalAmount = 0, totalProfit = 0, totalLoss = 0;

    trades.forEach((t, index) => {
        let row = `<tr>
            <td>${t.symbol}</td>
            <td>${t.side}</td>
            <td>${t.leverage}x</td>
            <td>${formatUSD(t.entry)}</td>
            <td>${t.targetType}</td>
            <td>${formatUSD(t.targetPrice)}</td>
            <td>${formatUSD(t.invest)}</td>
            <td class="${t.profitAmount >= 0 ? 'profit' : 'loss'}">${formatUSD(t.profitAmount)}</td>
            <td class="${t.finalAmount >= 0 ? 'profit' : 'loss'}">${formatUSD(t.finalAmount)}</td>
            <td>${t.date}</td>
            <td>
                <button onclick="editTrade(${index})">Edit</button>
                <button onclick="deleteTrade(${index})">Delete</button>
            </td>
        </tr>`;
        table.innerHTML += row;

        totalAmount += t.finalAmount;
        if (t.finalAmount >= 0) totalProfit += t.finalAmount;
        else totalLoss += t.finalAmount;
    });

    document.getElementById("totals").textContent =
        `Total Amount: ${formatUSD(totalAmount)} | Total Profit: ${formatUSD(totalProfit)} | Total Loss: ${formatUSD(totalLoss)}`;
}

function deleteTrade(index) {
    let trades = JSON.parse(localStorage.getItem("trades") || "[]");
    trades.splice(index, 1);
    localStorage.setItem("trades", JSON.stringify(trades));
    loadTrades();
}

function editTrade(index) {
    let trades = JSON.parse(localStorage.getItem("trades") || "[]");
    let t = trades[index];
    document.getElementById("symbol").value = t.symbol;
    document.getElementById("side").value = t.side;
    document.getElementById("leverage").value = t.leverage;
    document.getElementById("entry").value = t.entry;
    document.getElementById("targetType").value = t.targetType.toLowerCase();
    document.getElementById("targetPrice").value = t.targetPrice;
    document.getElementById("invest").value = t.invest;
    deleteTrade(index);
}

window.onload = loadTrades;
</script>

</body>
</html>
